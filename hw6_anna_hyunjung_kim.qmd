---
title: "hw6_anna_hyunjung_kim"
format: html
editor: visual
---

```{r}
#install.packages(c("tidyverse", "tidytext", "janeaustenr", "wordcloud", "stringr"))
#install.packages("textdata")

library(tidyverse)
library(tidytext)   
library(janeaustenr) 
library(stringr)
library(wordcloud)  
```

```{r}
austen <- austen_books()
austen

```

```{r}
emma_data <- austen %>%
  filter(book == "Emma")

#emma_data
chapter_data <- emma_data %>% 
  mutate(linenumber = row_number(),
         chapter = cumsum(str_detect(text, regex("^chapter\\s+\\d+\\b"))))


#chapter_data
```

```{r}
data(stop_words) 

emma_words <- chapter_data %>%
  unnest_tokens(word, text) %>% 
  mutate(word = str_extract(word, "[a-z']+")) %>%  
  filter(!is.na(word)) %>% 
  anti_join(stop_words, by = "word") 

emma_words
```

```{r}
nrc_joy <- get_sentiments("nrc") %>%
  filter(sentiment == "joy") %>%
  distinct(word)

nrc_joy

emma_nrc_counts <- emma_words %>%
  semi_join(nrc_joy, by = "word") %>%
  count(word, sort = TRUE) %>%
  filter(n > 50)

emma_nrc_counts 
```

```{r}
# Bar chart
ggplot(emma_nrc_counts, aes(x = reorder(word, n), y = n)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(title = "Frequent Joy Words in Emma (NRC)",
       x = "Word", y = "Frequency")
```

```{r}
set.seed(123)
wordcloud(words = emma_nrc_counts$word,
          freq = emma_nrc_counts$n,
          max.words = 100,
          colors = brewer.pal(8, "Dark2"))
```

```{r}
afinn_pos <- get_sentiments("afinn") %>%
  filter(value >= 1) %>%
  distinct(word)

afinn_pos 
```

```{r}

emma_afinn_counts <- emma_words %>%
  semi_join(afinn_pos, by = "word") %>%
  count(word, sort = TRUE) %>%
  filter(n > 50)

emma_afinn_counts
```

```{r}
ggplot(emma_afinn_counts, aes(x = reorder(word, n), y = n)) +
  geom_col(fill = "forestgreen") +
  coord_flip() +
  labs(title = "Frequent Positive Words in Emma (AFINN)",
       x = "Word", y = "Frequency")
s
set.seed(123)
wordcloud(words = emma_afinn_counts$word,
          freq = emma_afinn_counts$n,
          max.words = 100,
          colors = brewer.pal(8, "Set1"))
```
