---
title: "hw6_anna_hyunjung_kim"
format: html
editor: visual
---

```{r}
#install.packages(c("tidyverse", "tidytext", "janeaustenr", "wordcloud", "stringr"))
#install.packages("textdata")

library(tidyverse)
library(tidytext)   
library(janeaustenr) 
library(stringr)
library(wordcloud)  
```

```{r}
austen <- austen_books()
austen

```

```{r}
emma_data <- austen %>%
  filter(book == "Emma")

#emma_data
chapter_data <- emma_data %>% 
  mutate(linenumber = row_number(),
         chapter = cumsum(str_detect(text, regex("^chapter\\s+\\d+\\b"))))


chapter_data
```

```{r}
data(stop_words) 

emma_words <- chapter_data %>%
  unnest_tokens(word, text) %>% 
  mutate(word = str_extract(word, "[a-z']+")) %>%  
  filter(!is.na(word)) %>% 
  anti_join(stop_words, by = "word") 

emma_words
```

```{}
```

```{r}
library(forcats)

emma_words %>%
  count(word, sort = TRUE) %>%
  filter(n > 600) %>%
  mutate(word = fct_reorder(word, n)) %>%
  ggplot(aes(word, n)) +
  geom_col() +
  xlab(NULL)
```

```{r}
lex_nrc   <- get_sentiments("nrc")
lex_bing  <- get_sentiments("bing")
lex_afinn <- get_sentiments("afinn")
```

```{r}
nrc_words <- lex_nrc %>%
  filter(sentiment %in% c("joy", "positive")) %>%
  distinct(word)

nrc_words 
```

```{r}
nrc_pos_counts <- emma_words %>%
  semi_join(nrc_words, by = "word") %>%
  count(word, sort = TRUE) %>%
  filter(n > 50)

nrc_pos_counts
```

```{r}
bing_words <- lex_bing %>%
  filter(sentiment == "positive") %>%
  distinct(word)

bing_words

bing_pos_counts <- emma_words %>%
  semi_join(bing_words, by = "word") %>%
  count(word, sort = TRUE) %>%
  filter(n > 50)

bing_pos_counts
```

```{r}
afinn_words <- lex_afinn %>%
  filter(value >= 1) %>%
  distinct(word)

afinn_words 

afinn_pos_counts <- emma_words %>%
  semi_join(afinn_words, by = "word") %>%
  count(word, sort = TRUE) %>%
  filter(n > 50)

afinn_pos_counts 
```
